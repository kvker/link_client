{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../index.svelte",
    "../../index.svelte",
    "../../index.svelte"
  ],
  "sourcesContent": [
    "<script>\n  export let show = false;\n</script>\n\n<style>\n  #loading {\n    position: fixed;\n    top: 0;\n    left: 0;\n    align-items: center;\n    justify-content: center;\n    margin: 0 0 2em;\n    height: 100%;\n    width: 100%;\n    text-align: center;\n    vertical-align: top;\n    background-color: rgba(0, 0, 0, 0.2);\n  }\n  svg rect {\n    fill: #ff6700;\n  }\n</style>\n\n<div id=\"loading\" style=\"display: {show ? 'flex' : 'none'};\">\n  <svg\n    version=\"1.1\"\n    id=\"Layer_1\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    x=\"0px\"\n    y=\"0px\"\n    width=\"24px\"\n    height=\"30px\"\n    viewBox=\"0 0 24 30\"\n    style=\"enable-background:new 0 0 50 50;\"\n    xml:space=\"preserve\">\n    <rect x=\"0\" y=\"10\" width=\"4\" height=\"10\" fill=\"#333\" opacity=\"0.2\">\n      <animate\n        attributeName=\"opacity\"\n        attributeType=\"XML\"\n        values=\"0.2; 1; .2\"\n        begin=\"0s\"\n        dur=\"0.6s\"\n        repeatCount=\"indefinite\" />\n      <animate\n        attributeName=\"height\"\n        attributeType=\"XML\"\n        values=\"10; 20; 10\"\n        begin=\"0s\"\n        dur=\"0.6s\"\n        repeatCount=\"indefinite\" />\n      <animate\n        attributeName=\"y\"\n        attributeType=\"XML\"\n        values=\"10; 5; 10\"\n        begin=\"0s\"\n        dur=\"0.6s\"\n        repeatCount=\"indefinite\" />\n    </rect>\n    <rect x=\"8\" y=\"10\" width=\"4\" height=\"10\" fill=\"#333\" opacity=\"0.2\">\n      <animate\n        attributeName=\"opacity\"\n        attributeType=\"XML\"\n        values=\"0.2; 1; .2\"\n        begin=\"0.15s\"\n        dur=\"0.6s\"\n        repeatCount=\"indefinite\" />\n      <animate\n        attributeName=\"height\"\n        attributeType=\"XML\"\n        values=\"10; 20; 10\"\n        begin=\"0.15s\"\n        dur=\"0.6s\"\n        repeatCount=\"indefinite\" />\n      <animate\n        attributeName=\"y\"\n        attributeType=\"XML\"\n        values=\"10; 5; 10\"\n        begin=\"0.15s\"\n        dur=\"0.6s\"\n        repeatCount=\"indefinite\" />\n    </rect>\n    <rect x=\"16\" y=\"10\" width=\"4\" height=\"10\" fill=\"#333\" opacity=\"0.2\">\n      <animate\n        attributeName=\"opacity\"\n        attributeType=\"XML\"\n        values=\"0.2; 1; .2\"\n        begin=\"0.3s\"\n        dur=\"0.6s\"\n        repeatCount=\"indefinite\" />\n      <animate\n        attributeName=\"height\"\n        attributeType=\"XML\"\n        values=\"10; 20; 10\"\n        begin=\"0.3s\"\n        dur=\"0.6s\"\n        repeatCount=\"indefinite\" />\n      <animate\n        attributeName=\"y\"\n        attributeType=\"XML\"\n        values=\"10; 5; 10\"\n        begin=\"0.3s\"\n        dur=\"0.6s\"\n        repeatCount=\"indefinite\" />\n    </rect>\n  </svg>\n</div>\n",
    "<script>\n  import { push, pop, replace } from \"svelte-spa-router\";\n  import Loading from \"../../components/loading/index.svelte\";\n  import av from \"../../utils/av.js\";\n\n  // 表单字段\n  let username = \"\";\n  let password = \"\";\n\n  // md5加密密码\n  let md5_password = \"\";\n\n  let loading_show = false;\n  $: {\n    md5_password = md5(password);\n  }\n\n  async function login() {\n    if(username.length < 2 || !md5_password) {\n      alert('请输入合法账密')\n      return\n    }\n    loading_show = true;\n    try {\n      // 登录\n      await av.login({\n        username,\n        password: md5_password\n      });\n      push(\"/main\");\n    } catch (error) {\n      console.log(Object.keys(error));\n      alert(error.rawMessage);\n    }\n    loading_show = false;\n  }\n\n  /**\n   * 检测注册数据\n   */\n  function checkRegist() {\n    if (!username || !password) {\n      alert(`请输入账密`);\n      return;\n    } else if (password.length < 6) {\n      alert(`密码不少于6位`);\n      return;\n    }\n    if (confirm(`注册账密为: ${username}, ${password}, 请确认`)) {\n      regist();\n    }\n  }\n\n  /**\n   * 注册\n   */\n  async function regist() {\n    loading_show = true;\n    try {\n      // 注册\n      await av.regist({\n        username,\n        password: md5_password\n      });\n      push(\"/main\");\n    } catch (error) {\n      console.log(error);\n      alert(error.rawMessage);\n    }\n    loading_show = false;\n  }\n</script>\n\n<style>\n  #login_page {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    height: 100vh;\n    margin: 0 auto;\n  }\n  #login_page > * {\n    margin: 8px 0;\n  }\n</style>\n\n<div id=\"login_page\" class=\"half\">\n  <h1>林克</h1>\n  <!-- username, password -->\n  <input bind:value={username} type=\"text\" placeholder=\"用户名\" />\n  <input bind:value={password} type=\"password\" placeholder=\"密码, 不少于6位\" />\n  <button class=\"full\" on:click={login}>登录</button>\n  <button class=\"full\" on:click={checkRegist}>注册</button>\n</div>\n\n<Loading bind:show={loading_show} />\n",
    "<script>\n  import { push, pop, replace } from \"svelte-spa-router\";\n  import Loading from \"../../components/loading/index.svelte\";\n  import av from \"../../utils/av.js\";\n\n  let user = AV.User.current();\n  if (!user) {\n    replace(\"/\");\n  }\n  let loading_show = false;\n  // 条目统计\n  let list = [];\n  let list_count_content = \"\";\n\n  // 表单显示控制\n  let checked = false;\n  // 是否为编辑\n  let is_edit = false;\n  // 当前编辑的objectId\n  let edit_id = \"\";\n  // 搜索框实例\n  let seach_input;\n\n  // 表单字段\n  let username;\n  let phone;\n  let profession;\n  let remind;\n\n  getList();\n\n  /**\n   * 获取列表\n   * @param {number} page 页码\n   */\n  async function getList(search_value = \"\") {\n    loading_show = true;\n    try {\n      list = (await av.read(\"Contact\", q => {\n        q.equalTo(\"user\", user);\n        if (search_value) {\n          q.contains(\"username\", search_value);\n        }\n        q.limit(1000);\n      })).sort((a, b) =>\n        a.get(\"username\").localeCompare(b.get(\"username\"), \"zh-Hans-CN\", {\n          sensitivity: \"accent\"\n        })\n      );\n      list_count_content = `共${list.length}条`;\n    } catch (error) {\n      alert(error.rawMessage || error.message);\n    }\n    loading_show = false;\n  }\n\n  /**\n   * 搜索框变动监听\n   */\n  function changeSearchInput(e) {\n    if (e.keyCode === 13) {\n      // 回车\n      getList(e.target.value);\n    }\n  }\n\n  /**\n   * 表单确认\n   */\n  async function confirmForm() {\n    if (!username || !phone || !profession || !remind) {\n      alert(\"请输入全部内容\");\n      return;\n    }\n    // this.toggleModal(\"#modal_add\");\n    const body = {\n      username: username,\n      phone: phone,\n      profession: profession,\n      remind: remind,\n      user\n    };\n    loading_show = true;\n    try {\n      if (is_edit) {\n        // 编辑\n        await av.update(\"Contact\", edit_id, body);\n        checked = false;\n        alert(\"更新成功\");\n        getList();\n      } else {\n        // 新增\n        await av.create(\"Contact\", body);\n        checked = false;\n        alert(\"新增成功\");\n        getList();\n      }\n      updateForm();\n    } catch (error) {\n      alert(error.rawMessage || error.message);\n    }\n    loading_show = false;\n  }\n\n  /**\n   * 更新表单\n   */\n  function updateForm(json = {}) {\n    username = json.username || \"\";\n    phone = json.phone || \"\";\n    profession = json.profession || \"\";\n    remind = json.remind || \"\";\n  }\n\n  function logout() {\n    AV.User.logOut();\n    replace(\"/\");\n  }\n\n  /**\n   * 点击新增\n   */\n  function add(item, idx) {\n    checked = true;\n    is_edit = false;\n    updateForm();\n  }\n\n  /**\n   * 点击编辑\n   */\n  function edit(item, idx) {\n    checked = true;\n    is_edit = true;\n    edit_id = item.id;\n    updateForm(item.toJSON());\n  }\n\n  /**\n   * 点击删除\n   */\n  async function del(item, idx) {\n    if (confirm(\"确认删除吗?\")) {\n      loading_show = true;\n      try {\n        await av.delete(\"Contact\", item.id);\n        checked = false;\n        list.splice(idx, 1);\n        list = list;\n      } catch (error) {\n        alert(error.rawMessage || error.message);\n      }\n      loading_show = false;\n    }\n  }\n</script>\n\n<style>\n  nav {\n    position: sticky;\n    width: 100%;\n  }\n\n  .modal .content .half {\n    margin: 8px;\n  }\n\n  table {\n    width: 100%;\n  }\n\n  .error {\n    margin-left: 16px;\n  }\n</style>\n\n<nav>\n  <button class=\"btn btn-primary\" on:click={e => add()}>新增</button>\n  <button class=\"btn btn-warning\" on:click={logout}>退出</button>\n  <span class=\"list_count_content\" style=\"margin-left: 100px;\">\n    {list_count_content}\n  </span>\n  <div class=\"menu\">\n    <input class=\"form-control\"\n      placeholder=\"搜索\"\n      on:keypress={changeSearchInput}\n      bind:this={seach_input} />\n  </div>\n</nav>\n\n<table class=\"table table-striped\">\n  <thead>\n    <tr>\n      <th>姓名</th>\n      <th>号码</th>\n      <th>职业</th>\n      <th>备注</th>\n      <th>操作</th>\n    </tr>\n  </thead>\n  <tbody id=\"tbody\">\n    {#each list as item, idx (idx)}\n      <tr>\n        <td>{item.get('username')}</td>\n        <td>{item.get('phone')}</td>\n        <td>{item.get('profession')}</td>\n        <td>{item.get('remind')}</td>\n        <td>\n          <div class=\"btn-group\">\n            <button class=\"btn btn-primary\" on:click={e => edit(item, idx)}>\n              编辑\n            </button>\n            <button class=\"btn btn-danger\" on:click={e => del(item, idx)}>\n              删除\n            </button>\n          </div>\n        </td>\n      </tr>\n    {/each}\n  </tbody>\n</table>\n\n<div class=\"modal\">\n  <input class=\"form-control\" id=\"modal_add\" type=\"checkbox\" bind:checked />\n  <label for=\"modal_add\" class=\"overlay\" />\n  <article>\n    <header>\n      <h3>{is_edit ? '编辑' : '新增'}</h3>\n      <label for=\"modal_add\" class=\"close\">&times;</label>\n    </header>\n    <section class=\"content flex one center\">\n      <input class=\"form-control\"\n        bind:value={username}\n        placeholder=\"姓名\" />\n      <input class=\"form-control\"\n        bind:value={phone}\n        placeholder=\"号码\" />\n      <input class=\"form-control\"\n        bind:value={profession}\n        placeholder=\"职业\" />\n      <input class=\"form-control\" bind:value={remind} placeholder=\"备注\" />\n    </section>\n    <footer>\n      <label class=\"button\" on:click={confirmForm}>确定</label>\n      <label for=\"modal_add\" class=\"button dangerous\">取消</label>\n    </footer>\n  </article>\n</div>\n\n<Loading bind:show={loading_show} />\n"
  ],
  "names": [],
  "mappings": "AAKE,QAAQ,8BAAC,CAAC,AACR,QAAQ,CAAE,KAAK,CACf,GAAG,CAAE,CAAC,CACN,IAAI,CAAE,CAAC,CACP,WAAW,CAAE,MAAM,CACnB,eAAe,CAAE,MAAM,CACvB,MAAM,CAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CACf,MAAM,CAAE,IAAI,CACZ,KAAK,CAAE,IAAI,CACX,UAAU,CAAE,MAAM,CAClB,cAAc,CAAE,GAAG,CACnB,gBAAgB,CAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,AACtC,CAAC,AACD,kBAAG,CAAC,IAAI,eAAC,CAAC,AACR,IAAI,CAAE,OAAO,AACf,CAAC;ACsDD,WAAW,4BAAC,CAAC,AACX,OAAO,CAAE,IAAI,CACb,cAAc,CAAE,MAAM,CACtB,eAAe,CAAE,MAAM,CACvB,WAAW,CAAE,MAAM,CACnB,MAAM,CAAE,KAAK,CACb,MAAM,CAAE,CAAC,CAAC,IAAI,AAChB,CAAC,AACD,yBAAW,CAAG,cAAE,CAAC,AACf,MAAM,CAAE,GAAG,CAAC,CAAC,AACf,CAAC;AC0ED,GAAG,eAAC,CAAC,AACH,QAAQ,CAAE,MAAM,CAChB,KAAK,CAAE,IAAI,AACb,CAAC,AAMD,KAAK,eAAC,CAAC,AACL,KAAK,CAAE,IAAI,AACb,CAAC"
}